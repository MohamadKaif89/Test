<section class="tabs-carousel-section">

  <div class="tabs-header">
    {% for block in section.blocks %}
      <button class="tab-btn" data-tab="{{ block.id }}">
        {{ block.settings.tab_label }}
      </button>
    {% endfor %}
  </div>

  <div class="tabs-content">
    {% for block in section.blocks %}
      <div class="tab-panel" id="tab-{{ block.id }}">

        <div class="carousel" data-carousel="{{ block.id }}">

          {% assign products = "" %}

          {% if block.settings.source_type == 'collection' %}
            {% assign products = block.settings.collection.products %}
          {% else %}
            {% assign products = block.settings.product_list %}
          {% endif %}

          {% for product in products %}
            <div class="carousel-item">
              <a href="{{ product.url }}">
                <img src="{{ product.featured_image | img_url: '400x' }}" alt="{{ product.title }}"width="" height="">
                <h4>{{ product.title }}</h4>
                <p>{{ product.price | money }}</p>
              </a>
            </div>
          {% endfor %}

        </div>

      </div>
    {% endfor %}
  </div>

</section>


<style>
  .tabs-header {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
  }

  .tab-btn {
    padding: 10px 18px;
    background: #eee;
    border: none;
    cursor: pointer;
  }

  .tab-btn.active {
    background: black;
    color: white;
  }

  .tab-panel {
    display: none;
  }

  .tab-panel.active {
    display: block;
  }

  .carousel {
    display: flex;
    overflow-x: auto;
    gap: 20px;
    scroll-behavior: smooth;
  }

  .carousel-item {
    min-width: 200px;
    border: 1px solid #eee;
    padding: 12px;
  }

  .carousel-item img {
    width: 100%;
    height: auto;
  }
</style>


<script>
document.addEventListener("DOMContentLoaded", function () {

  document.querySelector(".tab-btn").classList.add("active");
  document.querySelector(".tab-panel").classList.add("active");

  document.querySelectorAll(".tab-btn").forEach(btn => {
    btn.addEventListener("click", () => {

      document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));
      document.querySelectorAll(".tab-panel").forEach(p => p.classList.remove("active"));
      btn.classList.add("active");
      let panel = document.querySelector(`#tab-${btn.dataset.tab}`);
      panel.classList.add("active");
    });
  });

});
</script>


{% schema %}
{
  "name": "Tabs with Carousel",
  "settings": [],
  "blocks": [
    {
      "type": "tab",
      "name": "Tab",
      "settings": [
        {
          "type": "text",
          "id": "tab_label",
          "label": "Tab label",
          "default": "New Tab"
        },
        {
          "type": "select",
          "id": "source_type",
          "label": "Choose product source",
          "options": [
            { "label": "Collection", "value": "collection" },
            { "label": "Product List", "value": "products" }
          ],
          "default": "collection"
        },
        {
          "type": "collection",
          "id": "collection",
          "label": "Select Collection"
        },
        {
          "type": "product_list",
          "id": "product_list",
          "label": "Select Products"
        }
      ]
    }
  ],
  "max_blocks": 12,
  "presets": [
    {
      "name": "Tabs Carousel"
    }
  ]
}
{% endschema %}
